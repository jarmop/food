(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{102:function(e,t,n){},104:function(e,t){t.firebase={apiKey:"AIzaSyBmq3141pSgbAxtW43ue1hDu7d0xPiPxLA",projectId:"food-38dea"}},107:function(e,t,n){e.exports=n(290)},112:function(e,t,n){},113:function(e,t,n){},22:function(e,t){t.basic=[{id:20,name:"Energia",male:2500,female:2e3,max:null,nutrientDensity:null,unit:"kcal"},{id:21,name:"Proteiini",male:100,female:90,max:null,nutrientDensity:null,unit:"g"},{id:22,name:"Rasva",male:70,female:70,max:null,nutrientDensity:null,unit:"g"},{id:23,name:"Hiilihydraatti",male:300,female:300,max:null,nutrientDensity:null,unit:"g"}],t.vitamins=[{id:1,name:"A-vitamiini",male:900,female:700,max:3e3,nutrientDensity:336,unit:"\xb5g"},{id:2,name:"D-vitamiini",male:10,female:10,max:100,nutrientDensity:5.5,unit:"\xb5g"},{id:3,name:"E-vitamiini",male:10,female:8,max:300,nutrientDensity:3.8,unit:"mg"},{id:4,name:"Tiamiini",male:1.5,female:1.1,max:null,nutrientDensity:.5,unit:"mg"},{id:5,name:"Riboflaviini",male:1.7,female:1.3,max:null,nutrientDensity:.6,unit:"mg"},{id:6,name:"Niasiini",male:20,female:15,max:null,nutrientDensity:6.7,unit:"mg"},{id:7,name:"B6-vitamiini",male:1.6,female:1.3,max:25,nutrientDensity:.5,unit:"mg"},{id:8,name:"Folaatti",male:300,female:400,max:1e3,nutrientDensity:189,unit:"\xb5g"},{id:9,name:"B12-vitamiini",male:2,female:2,max:null,nutrientDensity:.8,unit:"\xb5g"},{id:10,name:"C-vitamiini",male:75,female:75,max:1e3,nutrientDensity:34,unit:"mg"}],t.minerals=[{id:11,name:"Kalsium",male:800,female:800,max:2500,nutrientDensity:420,unit:"mg"},{id:12,name:"Fosfori",male:600,female:600,max:5e3,nutrientDensity:336,unit:"mg"},{id:13,name:"Kalium",male:3500,female:3100,max:3700,nutrientDensity:1500,unit:"mg"},{id:14,name:"Magnesium",male:350,female:280,max:null,nutrientDensity:147,unit:"mg"},{id:15,name:"Rauta",male:9,female:15,max:25,nutrientDensity:6.7,unit:"mg"},{id:16,name:"Sinkki",male:9,female:7,max:25,nutrientDensity:4.6,unit:"mg"},{id:18,name:"Jodi",male:150,female:150,max:600,nutrientDensity:71,unit:"\xb5g"},{id:19,name:"Seleeni",male:60,female:50,max:300,nutrientDensity:23,unit:"\xb5g"},{id:50,name:"Natrium",male:0,female:0,max:2e3,nutrientDensity:null,unit:"mg"},{id:51,name:"Suola",male:0,female:0,max:5e3,nutrientDensity:null,unit:"mg"}],t.fats=[{id:24,name:"Rasvahapot yhteens\xe4",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:25,name:"Monityydyttym\xe4tt\xf6m\xe4t",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:26,name:"Yksitt\xe4istyydyttym\xe4tt\xf6m\xe4t cis",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:27,name:"Tyydyttyneet",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:28,name:"Trans",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:29,name:"N-3",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:30,name:"N-6",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:31,name:"Linolihappo",male:null,female:null,max:null,nutrientDensity:null,unit:"mg"},{id:32,name:"Alfalinoleenihappo",male:null,female:null,max:null,nutrientDensity:null,unit:"mg"},{id:33,name:"EPA",male:null,female:null,max:null,nutrientDensity:null,unit:"mg"},{id:34,name:"DHA",male:null,female:null,max:null,nutrientDensity:null,unit:"mg"},{id:35,name:"Kolesteroli",male:null,female:null,max:null,nutrientDensity:null,unit:"mg"},{id:36,name:"Steroli",male:null,female:null,max:null,nutrientDensity:null,unit:"mg"}],t.carbs=[{id:37,name:"Kuitu",male:30,female:30,max:null,nutrientDensity:12.6,unit:"g"},{id:38,name:"Orgaaniset hapot",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:39,name:"Sokerialkoholi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:40,name:"T\xe4rkkelys",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:41,name:"Sokerit",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:42,name:"Fruktoosi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:43,name:"Galaktoosi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:44,name:"Glukoosi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:45,name:"Laktoosi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:46,name:"Maltoosi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:47,name:"Sakkaroosi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:48,name:"Polysakkaridi",male:null,female:null,max:null,nutrientDensity:null,unit:"g"},{id:49,name:"Veteen liukenematon kuitu",male:null,female:null,max:null,nutrientDensity:null,unit:"g"}]},286:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){},290:function(e,t,n){"use strict";n.r(t);var a=n(1),l=n.n(a),i=n(11),o=n.n(i),u=(n(112),n(12)),s=n(13),r=n(15),m=n(14),c=n(5),d=n(16),f=(n(113),n(60)),g=n.n(f),h=n(104),y=n.n(h);g.a.initializeApp(y.a.firebase);var b=g.a.firestore(),p=function(e){var t=null;return new Promise((function(n,a){b.collection("meals").doc(e).get().then((function(e){e.exists&&(t=e.data().foods),n(t)}))}))},v=function(e,t){b.collection("meals").doc(t).set({foods:e})},E=n(105),D=(n(284),n(285),n(286),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(r.a)(this,Object(m.a)(t).call(this,e))).state={foodId:null,amount:100},n.submit=n.submit.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"setFood",value:function(e){this.setState({foodId:e})}},{key:"setAmount",value:function(e){this.setState({amount:e})}},{key:"submit",value:function(){this.props.onAdd(this.state.foodId,this.state.amount),this.typeahead.getInstance().clear()}},{key:"render",value:function(){var e=this,t=this.props.foodOptions;return l.a.createElement("div",{className:"input-container"},l.a.createElement(E.Typeahead,{options:t,onChange:function(t){return e.setFood(parseInt(t.pop().id))},placeholder:"Valitse ruoka",ref:function(t){return e.typeahead=t}}),l.a.createElement("div",null,l.a.createElement("input",{className:"input-amount form-control",type:"number",defaultValue:100,onChange:function(t){return e.setAmount(parseInt(t.target.value))}})," g"),l.a.createElement("input",{className:"btn btn-primary",type:"button",value:"Lis\xe4\xe4",onClick:this.submit,disabled:!(this.state.foodId&&this.state.amount)}))}}]),t}(l.a.Component)),k=(n(287),function(e){var t=e.foods,n=e.mealFoods,a=e.selectedFoods,i=e.onDelete,o=e.onSelect,u=e.onToggleAll;return l.a.createElement("div",null,l.a.createElement("div",{className:"food-list"},n.map((function(e){return l.a.createElement("div",{className:"food"+(a.includes(e.id)?" food--selected":""),key:e.id,onClick:function(){return o(e.id)}},t[e.id].name,", ",e.amount," g")}))),l.a.createElement("div",{className:"food-list-actions"},l.a.createElement("button",{className:"btn btn-primary",onClick:u},n.length===a.length?"Poista valinnat":"Valitse kaikki"),a.length>0&&l.a.createElement("button",{className:"btn btn-danger",onClick:function(){return i(a)}},"Poista valitut")))}),x=n(22),_=n.n(x),F=(n(102),n(288),function(e){var t=e.max,n=e.part1,a=e.part2,i=t>0?Math.min(n/t*100,100):100,o=t>0?Math.min(a/t*100,Math.max(100-i,0)):0;return l.a.createElement("div",{className:"bar"},l.a.createElement("div",{className:"bar__fill",style:{width:i+"%"}}),l.a.createElement("div",{className:"bar__fill bar__fill--selected",style:{width:o+"%"}}))}),w=function(e){return e.toFixed(e>0&&e<10?1:0)},N=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(r.a)(this,Object(m.a)(t).call(this,e))).state={isVisible:!("isVisible"in e)||e.isVisible,isToggleEnabled:!("isToggleEnabled"in e)||e.isToggleEnabled},n.show=n.show.bind(Object(c.a)(n)),n.hide=n.hide.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"show",value:function(){this.setState({isVisible:!0})}},{key:"hide",value:function(){this.setState({isVisible:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dataArray,a=t.name;return l.a.createElement("tbody",{className:"nutrient-table__section"},!this.state.isVisible&&l.a.createElement("tr",null,l.a.createElement("td",{valign:"top"},l.a.createElement("button",{className:"nutrient-table__section-toggle",onClick:this.show},"+")),l.a.createElement("td",{colSpan:"6"},a)),this.state.isVisible&&n.map((function(t,a){return l.a.createElement("tr",{key:a},0===a&&l.a.createElement("td",{rowSpan:n.length,valign:"top"},e.state.isToggleEnabled&&l.a.createElement("button",{className:"nutrient-table__section-toggle",onClick:e.hide},"-")),l.a.createElement("td",{className:"nutrient-table__column nutrient-table__column--name"},t.name),l.a.createElement("td",{className:"nutrient-table__column nutrient-table__column--no-padding"},l.a.createElement("div",null,l.a.createElement(F,{max:t.recommendation,part1:t.part1,part2:t.part2}))),l.a.createElement("td",{className:"nutrient-table__column nutrient-table__column--received nutrient-table__column--no-padding"},w(t.total),"\xa0"),l.a.createElement("td",{className:"nutrient-table__column nutrient-table__column--recommended nutrient-table__column--no-padding"},null!==t.recommendation&&"/ "+w(t.recommendation)),l.a.createElement("td",{className:"nutrient-table__column"},t.max),l.a.createElement("td",{className:"nutrient-table__column"},t.unit))})))}}]),t}(l.a.Component),j=function(){return l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{className:"nutrient-table__column nutrient-table__column--toggle"}),l.a.createElement("th",{className:"nutrient-table__column nutrient-table__column--name"},"Nimi"),l.a.createElement("th",{className:"nutrient-table__column nutrient-table__column--amount",colSpan:"3"},"Saanti / suositus"),l.a.createElement("th",{className:"nutrient-table__column nutrient-table__column--max"},"Yl\xe4raja"),l.a.createElement("th",{className:"nutrient-table__column nutrient-table__column--unit"},"Yksikk\xf6")))},O=function(e,t,n){return e.map((function(e){return n.reduce((function(n,a){return n+a.amount/100*t[a.id].nutrients[e.id]}),0)}))},S=function(e,t,n,a,l,i,o){var u=n.length>0?O(l,e,n):null,s=O(l,e,a),r=u?O(l,e,t):s,m=[];return l.forEach((function(e,t){var n,a;m.push({name:e.name,recommendation:i&&e.nutrientDensity?(n=e.nutrientDensity,a=o,a/1e3*n):e.male,total:r[t]-(u?u[t]:0),max:e.max,unit:e.unit,part1:u?s[t]:r[t],part2:u?u[t]:0})})),m},T=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(r.a)(this,Object(m.a)(t).call(this,e))).state={showRelationToEnergy:!1},n.toggleMeasuringType=n.toggleMeasuringType.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"toggleMeasuringType",value:function(){this.setState({showRelationToEnergy:!this.state.showRelationToEnergy})}},{key:"render",value:function(){var e=this.props,t=e.foods,n=e.mealFoods,a=e.selectedFoods,i=n.filter((function(e){return a.includes(e.id)})),o=n.filter((function(e){return!a.includes(e.id)})),u=O(_.a.basic.slice(0,1),t,o).pop(),s=S(t,n,i,o,_.a.basic,this.state.showRelationToEnergy,u),r=S(t,n,i,o,_.a.minerals,this.state.showRelationToEnergy,u),m=S(t,n,i,o,_.a.vitamins,this.state.showRelationToEnergy,u),c=S(t,n,i,o,_.a.fats,this.state.showRelationToEnergy,u),d=S(t,n,i,o,_.a.carbs,this.state.showRelationToEnergy,u);return l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("input",{type:"checkbox",id:"energy",checked:this.state.showRelationToEnergy,onChange:this.toggleMeasuringType}),l.a.createElement("label",{htmlFor:"energy"},"\xa0Vertaa saatuun energiam\xe4\xe4r\xe4\xe4n")),l.a.createElement("table",{className:"nutrient-table"},l.a.createElement(j,null),l.a.createElement(N,{dataArray:s,isToggleEnabled:!1}),l.a.createElement(N,{dataArray:r,name:"Mineraalit"}),l.a.createElement(N,{dataArray:m,name:"Vitamiinit"}),l.a.createElement(N,{dataArray:c,name:"Rasvat"}),l.a.createElement(N,{dataArray:d,name:"Hiilihydraatit"})))}}]),t}(l.a.Component),A=(n(289),n(106)),C=n.n(A)()(),M=function(e){var t=e.onDateChange;return l.a.createElement("div",{className:"date-picker"},l.a.createElement("button",{className:"btn btn-primary",onClick:function(){return t(C.subtract(1,"days").toDate())}},"<"),l.a.createElement("span",{className:"selected-date"},C.format("D.M.YYYY")),l.a.createElement("button",{className:"btn btn-primary",onClick:function(){return t(C.add(1,"days").toDate())}},">"))},I={},R=[],V=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(r.a)(this,Object(m.a)(t).call(this))).state={initialized:!1,selectedFoods:[],mealFoods:[],date:new Date},n.addFood=n.addFood.bind(Object(c.a)(n)),n.deleteFood=n.deleteFood.bind(Object(c.a)(n)),n.toggleAll=n.toggleAll.bind(Object(c.a)(n)),n.setMealByDate=n.setMealByDate.bind(Object(c.a)(n)),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getMealIdByDate",value:function(e){return e.toDateString()}},{key:"getCurrentMealId",value:function(){return this.getMealIdByDate(this.state.date)}},{key:"componentDidMount",value:function(){var e=this;Promise.all([new Promise((function(e,t){b.collection("foods").get().then((function(t){var n={};t.forEach((function(e){var t=e.data();n[t.id]=t})),e(n)}))})),new Promise((function(e,t){b.collection("meals").get().then((function(t){var n=[];t.forEach((function(e){var t=e.data();n.push(t.foods)})),e(n)}))})),p(this.getCurrentMealId())]).then((function(t){I=t[0];var n=t[2];n||(n=[]),R=Object.keys(I).map((function(e){return{id:e,label:I[e].name}})),e.setState({mealFoods:n,initialized:!0})}))}},{key:"addFood",value:function(e,t){var n=this.state.mealFoods.slice(),a=!1;n=n.map((function(n){return e===n.id?(a=!0,{id:n.id,amount:n.amount+t}):n})),a||n.push({id:e,amount:t}),this.setState({mealFoods:n}),v(n,this.getCurrentMealId())}},{key:"deleteFood",value:function(e){var t=this.state.mealFoods.filter((function(t){return!e.includes(t.id)}));this.setState({mealFoods:t,selectedFoods:[]}),v(t,this.getCurrentMealId())}},{key:"selectFood",value:function(e){var t=this.state.selectedFoods.slice();t.includes(e)?t=t.filter((function(t){return t!==e})):t.push(e),this.setState({selectedFoods:t})}},{key:"toggleAll",value:function(){this.setState({selectedFoods:this.state.mealFoods.length===this.state.selectedFoods.length?[]:this.state.mealFoods.map((function(e){return e.id}))})}},{key:"setMealByDate",value:function(e){var t=this;p(this.getMealIdByDate(e)).then((function(n){n||(n=[]),t.setState({mealFoods:n,date:e})}))}},{key:"render",value:function(){var e=this;return this.state.initialized?l.a.createElement("div",{className:"grid"},l.a.createElement("div",null,l.a.createElement(M,{onDateChange:this.setMealByDate}),l.a.createElement(D,{foodOptions:R,onAdd:this.addFood}),l.a.createElement(k,{foods:I,mealFoods:this.state.mealFoods,selectedFoods:this.state.selectedFoods,onDelete:function(t){return e.deleteFood(t)},onSelect:function(t){return e.selectFood(t)},onToggleAll:this.toggleAll})),l.a.createElement("div",null,l.a.createElement(T,{foods:I,mealFoods:this.state.mealFoods,selectedFoods:this.state.selectedFoods}))):"not ready"}}]),t}(a.Component),B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function P(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(l.a.createElement(V,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/food",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/food","/service-worker.js");B?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):P(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):P(e)}))}}()}},[[107,1,2]]]);
//# sourceMappingURL=main.8b7112e5.chunk.js.map